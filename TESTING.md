# Тестирование проекта Stellar Burgers

Этот документ содержит информацию о тестировании приложения Stellar Burgers.

## Типы тестов

В проекте реализованы два типа тестов:

1. **Unit-тесты (Jest)** - для тестирования Redux-слайсов и редьюсеров
2. **E2E-тесты (Cypress)** - для интеграционного тестирования пользовательского интерфейса

## Запуск тестов

### Jest (Unit-тесты)

Для запуска всех unit-тестов выполните:

```bash
npm test
```

Для запуска тестов в режиме наблюдения (watch mode):

```bash
npm run test:watch
```

### Cypress (E2E-тесты)

Для запуска Cypress в интерактивном режиме:

```bash
npm run cypress:open
```

Для запуска Cypress в headless режиме:

```bash
npm run cypress:run
```

**Важно:** Перед запуском Cypress-тестов необходимо запустить приложение:

```bash
npm start
```

## Структура тестов

### Jest-тесты

Jest-тесты находятся рядом с тестируемыми файлами:

- `src/services/store.test.ts` - тесты для rootReducer
- `src/services/slices/constructorSlice.test.ts` - тесты для конструктора бургера
- `src/services/slices/ingredientsSlice.test.ts` - тесты для слайса ингредиентов
- `src/services/slices/orderSlice.test.ts` - тесты для слайса заказов

#### Что покрыто Jest-тестами:

1. **rootReducer** - проверка правильной инициализации хранилища
2. **constructorSlice**:
   - Добавление ингредиентов (булки, начинки, соусы)
   - Удаление ингредиентов
   - Изменение порядка ингредиентов
   - Очистка конструктора
3. **ingredientsSlice**:
   - Обработка состояния загрузки (pending)
   - Успешная загрузка данных (fulfilled)
   - Обработка ошибок (rejected)
4. **orderSlice**:
   - Создание заказа (pending/fulfilled/rejected)
   - Очистка данных заказа

### Cypress-тесты

Cypress-тесты находятся в папке `cypress/e2e/`:

- `cypress/e2e/constructor.cy.tsx` - тесты страницы конструктора

#### Что покрыто Cypress-тестами:

1. **Добавление ингредиентов**:
   - Добавление булки
   - Добавление основных ингредиентов
   - Добавление соусов
   - Добавление нескольких ингредиентов

2. **Модальные окна**:
   - Открытие модального окна с деталями ингредиента
   - Отображение корректных данных ингредиента
   - Закрытие по кнопке закрытия
   - Закрытие по клику на overlay

3. **Создание заказа**:
   - Успешное создание заказа
   - Проверка отображения номера заказа
   - Очистка конструктора после создания заказа
   - Валидация (нельзя создать заказ без булки)

4. **Дополнительные проверки**:
   - Отображение счетчиков ингредиентов
   - Drag and drop функциональность

### Моковые данные

Моковые данные для Cypress-тестов находятся в папке `cypress/fixtures/`:

- `ingredients.json` - список ингредиентов
- `user.json` - данные пользователя
- `order.json` - ответ на создание заказа

## Конфигурационные файлы

- `jest.config.js` - конфигурация Jest
- `cypress.config.ts` - конфигурация Cypress
- `src/setupTests.ts` - настройки окружения для Jest

## Требования к тестам

Все тесты соответствуют требованиям из технического задания:

✅ Настроены библиотеки Cypress и Jest
✅ Добавлены команды запуска тестов в package.json
✅ Тесты объединены в блоки `describe`
✅ Каждый тест имеет корректное описание
✅ Все тесты написаны на TypeScript
✅ Все тесты завершаются успешно

## Покрытие кода

Для просмотра покрытия кода тестами можно использовать:

```bash
npm test -- --coverage
```

Это создаст отчет о покрытии в папке `coverage/`.

## Troubleshooting

### Проблемы с Cypress

Если Cypress-тесты не проходят:

1. Убедитесь, что приложение запущено на `http://localhost:4000`
2. Проверьте, что все моковые данные корректны
3. Проверьте, что API endpoints правильно перехвачены

### Проблемы с Jest

Если Jest-тесты не проходят:

1. Убедитесь, что все зависимости установлены: `npm install`
2. Очистите кеш Jest: `npm test -- --clearCache`
3. Проверьте типизацию TypeScript

## Дополнительная информация

Для более детальной информации о тестировании обратитесь к:

- [Документация Jest](https://jestjs.io/)
- [Документация Cypress](https://www.cypress.io/)
- [Документация Testing Library](https://testing-library.com/)
